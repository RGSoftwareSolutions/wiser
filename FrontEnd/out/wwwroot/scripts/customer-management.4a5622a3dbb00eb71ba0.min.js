"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk"] = self["webpackChunk"] || []).push([["customer-management"],{

/***/ "./components/customer-management.js":
/*!*******************************************!*\
  !*** ./components/customer-management.js ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _scss_customer_management_scss__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../scss/customer-management.scss */ \"../scss/customer-management.scss\");\n/* provided dependency */ var console = __webpack_require__(/*! ../../node_modules/node-polyfill-webpack-plugin/node_modules/console-browserify/index.js */ \"../../node_modules/node-polyfill-webpack-plugin/node_modules/console-browserify/index.js\");\nï»¿\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\r\n    name: \"customerManagement\",\r\n    template: \"#customer-management-template\",\r\n    props: [\"subDomain\"],\r\n    data() {\r\n        return {\r\n            currentStep: 1,\r\n            lastStep: 2,\r\n            message: \"\",\r\n            errors: [],\r\n            loading: false,\r\n            newCustomerData: {\r\n                name: \"\",\r\n                subDomain: \"\",\r\n                isWebShop: false,\r\n                isConfigurator: false,\r\n                createNewDatabase: true,\r\n                digitalOceanApiAccessToken: \"\",\r\n                databaseHost: \"\",\r\n                databaseUsername: \"\",\r\n                databasePassword: \"\",\r\n                databaseSchema: \"\",\r\n                databasePort: 25060,\r\n                dbClusterChoice: \"\",\r\n                dataUrlLive: \"\",\r\n                dataUrlTest: \"\",\r\n                hostLive: \"\",\r\n                hostTest: \"\",\r\n                hostDev: \"\",\r\n                siteName: \"\"\r\n            },\r\n            createCustomerResult: {\r\n                data: {}\r\n            },\r\n            availableDbClusters: []\r\n        };\r\n    },\r\n    async created() {\r\n    },\r\n    computed: {\r\n        nextButtonText() {\r\n            return this.currentStep >= this.lastStep ? \"Opslaan\" : \"Verder\";\r\n        }\r\n    },\r\n    methods: {\r\n        previousStep(event) {\r\n            event.preventDefault();\r\n            this.currentStep = this.currentStep > 1 ? this.currentStep - 1 : 1;\r\n        },\r\n\r\n        async nextStep(event) {\r\n            this.message = \"\";\r\n            if (!event.target.closest(\"form\").checkValidity()) {\r\n                return;\r\n            }\r\n\r\n            event.preventDefault();\r\n\r\n            switch (this.currentStep) {\r\n            case 1:\r\n                if (!await this.handleStep1()) {\r\n                    return;\r\n                }\r\n                break;\r\n            case 2:\r\n                if (!await this.handleStep2()) {\r\n                    return;\r\n                }\r\n\r\n                this.currentStep = \"end\";\r\n                return;\r\n            default:\r\n                console.warn(\"Unknown/invalid step\", this.currentStep);\r\n                break;\r\n            }\r\n\r\n            this.currentStep++;\r\n        },\r\n\r\n        reset() {\r\n            this.message = \"\";\r\n            this.errors = [];\r\n            this.newCustomerData = {\r\n                name: \"\",\r\n                subDomain: \"\",\r\n                isWebShop: false,\r\n                isConfigurator: false,\r\n                isMultiLanguage: false,\r\n                createNewDatabase: true,\r\n                digitalOceanApiAccessToken: \"\",\r\n                databaseHost: \"\",\r\n                databaseUsername: \"\",\r\n                databasePassword: \"\",\r\n                databaseSchema: \"\",\r\n                databasePort: 25060,\r\n                dbClusterChoice: \"\",\r\n                dataUrlLive: \"\",\r\n                dataUrlTest: \"\",\r\n                hostLive: \"\",\r\n                hostTest: \"\",\r\n                hostDev: \"\",\r\n                siteName: \"\"\r\n            };\r\n            this.availableDbClusters = [];\r\n            this.currentStep = 1;\r\n        },\r\n\r\n        async getDbClusters() {\r\n            this.message = \"\";\r\n            this.errors = [];\r\n            this.loading = true;\r\n            const result = await main.customersService.getDbClusters(this.newCustomerData.digitalOceanApiAccessToken);\r\n            this.loading = false;\r\n            if (!result.success) {\r\n                this.message = result.message;\r\n            } else {\r\n                this.availableDbClusters = result.data.databases;\r\n            }\r\n        },\r\n\r\n        async createDatabaseAndUser() {\r\n            this.loading = true;\r\n            const result = await main.customersService.createDatabaseAndUser(this.newCustomerData.dbClusterChoice, this.newCustomerData.databaseSchema, this.newCustomerData.databaseUsername, this.newCustomerData.digitalOceanApiAccessToken);\r\n            this.loading = false;\r\n            if (!result.success) {\r\n                this.message = result.message;\r\n                return result;\r\n            }\r\n\r\n            for (let user of result.data.users) {\r\n                if (user.name.endsWith(\"_wiser\")) {\r\n                    this.newCustomerData.databasePassword = user.password;\r\n                    this.newCustomerData.databaseUsername = user.name;\r\n                    break;\r\n                }\r\n            }\r\n            \r\n            this.newCustomerData.databaseHost = result.data.cluster.database.connection.host;\r\n            this.newCustomerData.databasePort = result.data.cluster.database.connection.port;\r\n            return result;\r\n        },\r\n\r\n        async handleStep1() {\r\n            this.message = \"\";\r\n            this.errors = [];\r\n            this.loading = true;\r\n            const result = await main.customersService.exists(this.newCustomerData.name, this.newCustomerData.subDomain);\r\n            this.loading = false;\r\n\r\n            if (!result.success) {\r\n                this.message = result.message;\r\n                return false;\r\n            }\r\n\r\n            if (result.data === \"Available\") {\r\n                return true;\r\n            }\r\n\r\n            this.errors = (result.data || \"\").split(\", \");\r\n            return false;\r\n        },\r\n\r\n        async handleStep2() {\r\n            let databaseResult;\r\n            if (this.newCustomerData.createNewDatabase) {\r\n                if (!this.newCustomerData.dbClusterChoice) {\r\n                    this.message = \"Kies eerst een databasecluster\";\r\n                    return false;\r\n                }\r\n\r\n                databaseResult = await this.createDatabaseAndUser();\r\n                if (!databaseResult.success) {\r\n                    return false;\r\n                }\r\n            } else {\r\n                databaseResult = {\r\n                    data: {\r\n                        users: [\r\n                            {\r\n                                name: this.newCustomerData.databaseUsername,\r\n                                password: this.newCustomerData.databasePassword\r\n                            }\r\n                        ]\r\n                    }\r\n                };\r\n            }\r\n\r\n            const newCustomer = {\r\n                name: this.newCustomerData.name,\r\n                database: {\r\n                    host: this.newCustomerData.databaseHost,\r\n                    username: this.newCustomerData.databaseUsername,\r\n                    password: this.newCustomerData.databasePassword,\r\n                    databaseName: this.newCustomerData.databaseSchema,\r\n                    portNumber: this.newCustomerData.databasePort\r\n                },\r\n                subDomain: this.newCustomerData.subDomain,\r\n                wiserSettings: {\r\n                    hostLive: this.newCustomerData.hostLive,\r\n                    hostTest: this.newCustomerData.hostTest,\r\n                    hostDev: this.newCustomerData.hostDev,\r\n                    siteName: this.newCustomerData.siteName\r\n                },\r\n                properties: {\r\n                    imagespath: \"images;images\",\r\n                    flashpath: \"flash;flash\",\r\n                    documentpath: \"documents;documents\",\r\n                    templatespath: \"templates;templates\",\r\n                    imagesRootID: \"1\",\r\n                    filesRootID: \"2\",\r\n                    templatesRootID: \"3\",\r\n                    flashRootID: \"4\",\r\n                    mediaRootID: \"5\",\r\n                    linkreplace: \"/{pagename}/\",\r\n                    XHTML: \"false\",\r\n                    enableSEO: \"false\",\r\n                    urlstolower: \"true\",\r\n                    canredirectwebpage: \"false\",\r\n                    loadatonce: \"false\",\r\n                    canhandledynamiccontent: \"false\",\r\n                    linksuffix: \"/\",\r\n                    linkprefix: \"/\",\r\n                    useRedirectImport: \"false\",\r\n                    useWebservice: \"0\",\r\n                    EnableContentBuilder: \"true\"\r\n                }\r\n            };\r\n\r\n            this.loading = true;\r\n            this.createCustomerResult = await main.customersService.create(newCustomer, this.newCustomerData.isWebShop, this.newCustomerData.isConfigurator, this.newCustomerData.isMultiLanguage);\r\n            this.createCustomerResult.databaseUsers = databaseResult.data.users;\r\n\t\t\t// For testing CSS/HTML, comment the line above and uncomment the code below.\r\n            /*this.createCustomerResult = {\r\n                success: true,\r\n                data: {\r\n                    id: 123,\r\n                    wiser2_encryption_key: \"DIT_IS&EEN-TEST\",\r\n                    wiser2_encryption_key_test: \"ER_is_geen_echte_klant_aangemaakt\"\r\n                }\r\n            };*/\r\n            this.loading = false;\r\n\r\n            if (!this.createCustomerResult || !this.createCustomerResult.success) {\r\n                this.message = this.createCustomerResult.message;\r\n                return false;\r\n            }\r\n\r\n            return true;\r\n        }\r\n    }\r\n});\n\n//# sourceURL=webpack:///./components/customer-management.js?");

/***/ }),

/***/ "../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!../scss/customer-management.scss":
/*!*****************************************************************************************************************************!*\
  !*** ../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!../scss/customer-management.scss ***!
  \*****************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../node_modules/css-loader/dist/runtime/noSourceMaps.js */ \"../../node_modules/css-loader/dist/runtime/noSourceMaps.js\");\n/* harmony import */ var _node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../node_modules/css-loader/dist/runtime/api.js */ \"../../node_modules/css-loader/dist/runtime/api.js\");\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".new-customer-form .step input.small {\\n  min-width: 300px;\\n  width: 300px;\\n}\", \"\"]);\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n//# sourceURL=webpack:///../scss/customer-management.scss?../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js");

/***/ }),

/***/ "../scss/customer-management.scss":
/*!****************************************!*\
  !*** ../scss/customer-management.scss ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! !../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ \"../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! !../../node_modules/style-loader/dist/runtime/styleDomAPI.js */ \"../../node_modules/style-loader/dist/runtime/styleDomAPI.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! !../../node_modules/style-loader/dist/runtime/insertBySelector.js */ \"../../node_modules/style-loader/dist/runtime/insertBySelector.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! !../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js */ \"../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! !../../node_modules/style-loader/dist/runtime/insertStyleElement.js */ \"../../node_modules/style-loader/dist/runtime/insertStyleElement.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! !../../node_modules/style-loader/dist/runtime/styleTagTransform.js */ \"../../node_modules/style-loader/dist/runtime/styleTagTransform.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _node_modules_css_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_customer_management_scss__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! !!../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./customer-management.scss */ \"../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!../scss/customer-management.scss\");\n\n      \n      \n      \n      \n      \n      \n      \n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = (_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default());\noptions.setAttributes = (_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default());\n\n      options.insert = _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default().bind(null, \"head\");\n    \noptions.domAPI = (_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default());\noptions.insertStyleElement = (_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default());\n\nvar update = _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_node_modules_css_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_customer_management_scss__WEBPACK_IMPORTED_MODULE_6__[\"default\"], options);\n\n\n\n\n       /* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_node_modules_css_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_customer_management_scss__WEBPACK_IMPORTED_MODULE_6__[\"default\"] && _node_modules_css_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_customer_management_scss__WEBPACK_IMPORTED_MODULE_6__[\"default\"].locals ? _node_modules_css_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_customer_management_scss__WEBPACK_IMPORTED_MODULE_6__[\"default\"].locals : undefined);\n\n\n//# sourceURL=webpack:///../scss/customer-management.scss?");

/***/ })

}]);